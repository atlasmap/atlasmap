<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../../jacoco-resources/report.gif" type="image/gif"/><title>JsonFieldWriter.java</title><link rel="stylesheet" href="../../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../../index.html" class="el_report">Unit Test Coverage Report</a> &gt; <a href="../index.html" class="el_bundle">atlas-json-core</a> &gt; <a href="index.source.html" class="el_package">io.atlasmap.json.core</a> &gt; <span class="el_source">JsonFieldWriter.java</span></div><h1>JsonFieldWriter.java</h1><pre class="source lang-java linenums">/*
 * Copyright (C) 2017 Red Hat, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *         http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
package io.atlasmap.json.core;

import java.math.BigDecimal;
import java.math.BigInteger;

import org.slf4j.LoggerFactory;

import com.fasterxml.jackson.core.util.DefaultPrettyPrinter;
import com.fasterxml.jackson.databind.JsonNode;
import com.fasterxml.jackson.databind.MapperFeature;
import com.fasterxml.jackson.databind.ObjectMapper;
import com.fasterxml.jackson.databind.node.ArrayNode;
import com.fasterxml.jackson.databind.node.ContainerNode;
import com.fasterxml.jackson.databind.node.JsonNodeType;
import com.fasterxml.jackson.databind.node.ObjectNode;

import io.atlasmap.api.AtlasException;
import io.atlasmap.core.AtlasPath;
import io.atlasmap.core.AtlasPath.SegmentContext;
import io.atlasmap.spi.AtlasFieldWriter;
import io.atlasmap.spi.AtlasInternalSession;
import io.atlasmap.v2.AtlasModelFactory;
import io.atlasmap.v2.CollectionType;
import io.atlasmap.v2.Field;
import io.atlasmap.v2.FieldStatus;
import io.atlasmap.v2.FieldType;

/**
 */
public class JsonFieldWriter implements AtlasFieldWriter {
<span class="fc" id="L46">    private static final org.slf4j.Logger LOG = LoggerFactory.getLogger(JsonFieldWriter.class);</span>

<span class="pc" id="L48">    private ObjectMapper objectMapper = null;</span>
<span class="pc" id="L49">    private ContainerNode&lt;?&gt; rootNode = null;</span>

<span class="fc" id="L51">    public JsonFieldWriter() {</span>
<span class="fc" id="L52">        this.objectMapper = new ObjectMapper()</span>
<span class="fc" id="L53">            .enable(MapperFeature.BLOCK_UNSAFE_POLYMORPHIC_BASE_TYPES)</span>
<span class="fc" id="L54">            .setDefaultPrettyPrinter(new DefaultPrettyPrinter());</span>
<span class="fc" id="L55">    }</span>

<span class="nc" id="L57">    public JsonFieldWriter(ObjectMapper objectMapper) {</span>
<span class="nc" id="L58">        this.objectMapper = objectMapper;</span>
<span class="nc" id="L59">    }</span>

    public ContainerNode&lt;?&gt; getRootNode() {
<span class="fc" id="L62">        return rootNode;</span>
    }

    public ObjectMapper getObjectMapper() {
<span class="fc" id="L66">        return objectMapper;</span>
    }

    @Override
    public void write(AtlasInternalSession session) throws AtlasException {
<span class="fc" id="L71">        Field targetField = session.head().getTargetField();</span>
<span class="fc bfc" id="L72" title="All 2 branches covered.">        if (targetField == null) {</span>
<span class="fc" id="L73">            throw new AtlasException(new IllegalArgumentException(&quot;Argument 'jsonField' cannot be null&quot;));</span>
        }
<span class="pc bpc" id="L75" title="1 of 2 branches missed.">        if (LOG.isDebugEnabled()) {</span>
<span class="nc" id="L76">            LOG.debug(&quot;Field: &quot; + AtlasModelFactory.toString(targetField));</span>
<span class="nc" id="L77">            LOG.debug(&quot;Field type=&quot; + targetField.getFieldType() + &quot; path=&quot; + targetField.getPath() + &quot; v=&quot;</span>
<span class="nc" id="L78">                    + targetField.getValue());</span>
        }
<span class="fc" id="L80">        AtlasPath path = new AtlasPath(targetField.getPath());</span>
<span class="fc" id="L81">        SegmentContext lastSegment = path.getLastSegment();</span>

<span class="fc bfc" id="L83" title="All 2 branches covered.">        if (this.rootNode == null) {</span>
<span class="fc bfc" id="L84" title="All 2 branches covered.">            if (path.hasCollectionRoot()) {</span>
<span class="fc" id="L85">                this.rootNode = objectMapper.createArrayNode();</span>
            } else {
<span class="fc" id="L87">                this.rootNode = objectMapper.createObjectNode();</span>
            }
        }
<span class="fc" id="L90">        ContainerNode&lt;?&gt; parentNode = this.rootNode;</span>

<span class="fc" id="L92">        SegmentContext parentSegment = null;</span>
<span class="fc bfc" id="L93" title="All 2 branches covered.">        for (SegmentContext segment : path.getSegments(true)) {</span>
<span class="fc bfc" id="L94" title="All 2 branches covered.">            if (!segment.equals(lastSegment)) { // this is a parent node.</span>
<span class="pc bpc" id="L95" title="1 of 2 branches missed.">                if (LOG.isDebugEnabled()) {</span>
<span class="nc" id="L96">                    LOG.debug(&quot;Now processing parent segment: &quot; + segment);</span>
                }
                JsonNode childNode;
<span class="fc bfc" id="L99" title="All 2 branches covered.">                if (segment.isRoot()) {</span>
<span class="fc bfc" id="L100" title="All 2 branches covered.">                    if (parentNode instanceof ArrayNode) {</span>
                        // taking care of topmost collection
<span class="fc" id="L102">                        childNode = parentNode;</span>
                    } else {
<span class="fc" id="L104">                        parentSegment = segment;</span>
<span class="fc" id="L105">                        continue;</span>
                    }
                } else {
<span class="fc" id="L108">                    childNode = getChildNode(parentNode, parentSegment, segment);</span>
                }
<span class="fc bfc" id="L110" title="All 2 branches covered.">                if (childNode == null) {</span>
<span class="fc" id="L111">                    childNode = createParentNode(parentNode, parentSegment, segment, targetField);</span>
<span class="fc bfc" id="L112" title="All 2 branches covered.">                } else if (childNode instanceof ArrayNode) {</span>
<span class="fc" id="L113">                    Integer index = segment.getCollectionIndex();</span>
<span class="fc bfc" id="L114" title="All 2 branches covered.">                    if (index == null) {</span>
<span class="fc" id="L115">                        return;</span>
                    }

<span class="fc" id="L118">                    ArrayNode arrayChild = (ArrayNode) childNode;</span>
<span class="fc bfc" id="L119" title="All 2 branches covered.">                    if (arrayChild.size() &lt; (index + 1)) {</span>
<span class="pc bpc" id="L120" title="1 of 2 branches missed.">                        if (LOG.isDebugEnabled()) {</span>
<span class="nc" id="L121">                            LOG.debug(&quot;Object Array is too small, resizing to accomodate index: &quot; + index</span>
                                    + &quot;, current array: &quot; + arrayChild);
                        }
                        // if our array doesn't have index + 1 items in it, add nulls until we have the
                        // index available
<span class="fc bfc" id="L126" title="All 2 branches covered.">                        while (arrayChild.size() &lt; (index + 1)) {</span>
<span class="fc" id="L127">                            arrayChild.addObject();</span>
                        }
<span class="pc bpc" id="L129" title="1 of 2 branches missed.">                        if (LOG.isDebugEnabled()) {</span>
<span class="nc" id="L130">                            LOG.debug(&quot;Object Array after resizing: &quot; + arrayChild);</span>
                        }
                    }
<span class="fc" id="L133">                    childNode = arrayChild.get(index);</span>
                }
<span class="fc bfc" id="L135" title="All 2 branches covered.">                if (childNode == null) {</span>
<span class="fc" id="L136">                    return;</span>
                }
<span class="fc" id="L138">                parentNode = (ObjectNode) childNode;</span>
<span class="fc" id="L139">                parentSegment = segment;</span>
<span class="fc" id="L140">            } else { // this is the last segment of the path, write the value</span>
<span class="fc bfc" id="L141" title="All 2 branches covered.">                if (targetField.getFieldType() == FieldType.COMPLEX) {</span>
<span class="fc" id="L142">                    createParentNode(parentNode, parentSegment, segment, targetField);</span>
<span class="fc" id="L143">                    return;</span>
                }
<span class="pc bpc" id="L145" title="1 of 2 branches missed.">                if (LOG.isDebugEnabled()) {</span>
<span class="nc" id="L146">                    LOG.debug(&quot;Now processing field value segment: &quot; + segment);</span>
                }
<span class="fc" id="L148">                writeValue(parentNode, parentSegment, segment, targetField);</span>
            }
<span class="fc" id="L150">        }</span>
<span class="fc" id="L151">    }</span>

    private void writeValue(ContainerNode&lt;?&gt; parentNode, SegmentContext parentSegment, SegmentContext segment, Field field)
            throws AtlasException {
<span class="pc bpc" id="L155" title="1 of 2 branches missed.">        if (LOG.isDebugEnabled()) {</span>
<span class="nc" id="L156">            LOG.debug(&quot;Writing field value '&quot; + segment + &quot;' in parent node '&quot; + parentSegment + &quot;', parentNode: &quot;</span>
                    + parentNode);
        }
<span class="fc" id="L159">        JsonNode valueNode = createValueNode(field);</span>
<span class="pc bpc" id="L160" title="1 of 2 branches missed.">        if (LOG.isDebugEnabled()) {</span>
<span class="nc" id="L161">            LOG.debug(&quot;Value to write: &quot; + valueNode);</span>
        }
<span class="fc" id="L163">        String cleanedSegment = segment.getName();</span>
<span class="fc bfc" id="L164" title="All 2 branches covered.">        if (segment.getCollectionType() != CollectionType.NONE) {</span>
            // if this field is a collection, we need to place our value in an array

            // get or construct the array the value will be placed in
<span class="pc bpc" id="L168" title="1 of 2 branches missed.">            if (LOG.isDebugEnabled()) {</span>
<span class="nc" id="L169">                LOG.debug(&quot;Field type is collection. Fetching array '&quot; + segment + &quot;' from parent '&quot; + parentSegment</span>
                        + &quot;': &quot; + parentNode);
            }

            ArrayNode arrayChild;
<span class="pc bpc" id="L174" title="2 of 6 branches missed.">            if (parentSegment == null &amp;&amp; cleanedSegment.isEmpty() &amp;&amp; this.rootNode instanceof ArrayNode) {</span>
                // taking care of topmost collection
<span class="fc" id="L176">                arrayChild = (ArrayNode)parentNode;</span>
            } else {
<span class="fc" id="L178">                arrayChild = (ArrayNode) getChildNode(parentNode, parentSegment, segment);</span>
            }
<span class="fc bfc" id="L180" title="All 2 branches covered.">            if (arrayChild == null) {</span>
<span class="pc bpc" id="L181" title="1 of 2 branches missed.">                if (parentNode instanceof ObjectNode) {</span>
<span class="fc" id="L182">                    arrayChild = ((ObjectNode)parentNode).putArray(cleanedSegment);</span>
<span class="nc bnc" id="L183" title="All 2 branches missed.">                } else if (parentNode instanceof ArrayNode) {</span>
<span class="nc" id="L184">                    arrayChild = ((ArrayNode)parentNode).addArray();</span>
                } else {
<span class="nc" id="L186">                    throw new AtlasException(String.format(&quot;Unknown JsonNode type '%s' for segment '%s'&quot;,</span>
<span class="nc" id="L187">                            parentNode.getClass(), segment));</span>
                }
<span class="pc bpc" id="L189" title="1 of 2 branches missed.">                if (LOG.isDebugEnabled()) {</span>
<span class="nc" id="L190">                    LOG.debug(&quot;Could not find array to place value in, created it in parent: &quot; + parentNode);</span>
                }
            }

<span class="pc bpc" id="L194" title="1 of 2 branches missed.">            if (LOG.isDebugEnabled()) {</span>
<span class="nc" id="L195">                LOG.debug(&quot;Array before placing value: &quot; + arrayChild);</span>
            }

            // determine where in the array our value will go
<span class="fc" id="L199">            Integer index = segment.getCollectionIndex();</span>
<span class="fc bfc" id="L200" title="All 2 branches covered.">            if (index == null) {</span>
                // No index is specified in the collection path
<span class="fc" id="L202">                return;</span>
            }

<span class="pc bpc" id="L205" title="1 of 2 branches missed.">            if (arrayChild.size() &lt; (index + 1)) {</span>
<span class="pc bpc" id="L206" title="1 of 2 branches missed.">                if (LOG.isDebugEnabled()) {</span>
<span class="nc" id="L207">                    LOG.debug(&quot;Value Array is too small, resizing to accomodate index: &quot; + index + &quot;, current array: &quot;</span>
                            + arrayChild);
                }
                // if our array doesn't have index + 1 items in it, add nulls until we have the
                // index available
<span class="fc bfc" id="L212" title="All 2 branches covered.">                while (arrayChild.size() &lt; (index + 1)) {</span>
<span class="fc" id="L213">                    arrayChild.addNull();</span>
                }
<span class="pc bpc" id="L215" title="1 of 2 branches missed.">                if (LOG.isDebugEnabled()) {</span>
<span class="nc" id="L216">                    LOG.debug(&quot;Value Array after resizing: &quot; + arrayChild);</span>
                }
            }

            // set the value in the array
<span class="fc" id="L221">            arrayChild.set(index, valueNode);</span>
<span class="fc bfc" id="L222" title="All 2 branches covered.">        } else if (field.getStatus() != FieldStatus.NOT_FOUND) {</span>
<span class="pc bpc" id="L223" title="1 of 2 branches missed.">            if (parentNode instanceof ArrayNode) {</span>
<span class="nc" id="L224">                ((ArrayNode)parentNode).add(valueNode);</span>
<span class="pc bpc" id="L225" title="1 of 2 branches missed.">            } else if (parentNode instanceof ObjectNode) {</span>
<span class="fc" id="L226">                ((ObjectNode)parentNode).replace(cleanedSegment, valueNode);</span>
            } else {
<span class="nc" id="L228">                throw new AtlasException(String.format(&quot;Unknown JsonNode type '%s' for segment '%s'&quot;,</span>
<span class="nc" id="L229">                        parentNode.getClass(), segment));</span>
            }
        }

<span class="pc bpc" id="L233" title="1 of 2 branches missed.">        if (LOG.isDebugEnabled()) {</span>
<span class="nc" id="L234">            LOG.debug(&quot;Parent node after value written: &quot; + parentNode);</span>
        }
<span class="fc" id="L236">    }</span>

    private ObjectNode createParentNode(ContainerNode&lt;?&gt; parentNode, SegmentContext parentSegment, SegmentContext segment, Field targetField)
            throws AtlasException {
<span class="pc bpc" id="L240" title="1 of 2 branches missed.">        if (LOG.isDebugEnabled()) {</span>
<span class="nc" id="L241">            LOG.debug(&quot;Creating parent node '&quot; + segment + &quot;' under previous parent '&quot; + parentSegment + &quot;' (&quot;</span>
<span class="nc" id="L242">                    + parentNode.getClass().getName() + &quot;)&quot;);</span>
        }
<span class="fc" id="L244">        ObjectNode childNode = null;</span>
<span class="fc" id="L245">        String cleanedSegment = segment.getName();</span>
<span class="fc bfc" id="L246" title="All 2 branches covered.">        if (segment.getCollectionType() != CollectionType.NONE) {</span>
            ArrayNode arrayChild;
<span class="pc bpc" id="L248" title="1 of 2 branches missed.">            if (parentNode instanceof ObjectNode) {</span>
<span class="fc" id="L249">                arrayChild = ((ObjectNode)parentNode).putArray(cleanedSegment);</span>
<span class="nc bnc" id="L250" title="All 2 branches missed.">            } else if (parentNode instanceof ArrayNode) {</span>
<span class="nc" id="L251">                arrayChild = ((ArrayNode)parentNode).addArray();</span>
            } else {
<span class="nc" id="L253">                throw new AtlasException(String.format(&quot;Unknown JsonNode type '%s' for segment '%s'&quot;,</span>
<span class="nc" id="L254">                        parentNode.getClass(), segment));</span>
            }
<span class="fc" id="L256">            Integer index = segment.getCollectionIndex();</span>

<span class="fc bfc" id="L258" title="All 2 branches covered.">            if (index == null) {</span>
                // No index is specified in the collection path - create only an array node and leave it empty
<span class="fc" id="L260">                return null;</span>
<span class="pc bpc" id="L261" title="1 of 2 branches missed.">            } else if (arrayChild.size() &lt; (index + 1)) {</span>
<span class="pc bpc" id="L262" title="1 of 2 branches missed.">                if (LOG.isDebugEnabled()) {</span>
<span class="nc" id="L263">                    LOG.debug(&quot;Object Array is too small, resizing to accomodate index: &quot; + index + &quot;, current array: &quot;</span>
                            + arrayChild);
                }
                // if our array doesn't have index + 1 items in it, add objects until we have
                // the index available
<span class="fc bfc" id="L268" title="All 2 branches covered.">                while (arrayChild.size() &lt; (index + 1)) {</span>
<span class="fc" id="L269">                    arrayChild.addObject();</span>
                }
<span class="pc bpc" id="L271" title="1 of 2 branches missed.">                if (LOG.isDebugEnabled()) {</span>
<span class="nc" id="L272">                    LOG.debug(&quot;Object Array after resizing: &quot; + arrayChild);</span>
                }
            }
<span class="pc bpc" id="L275" title="1 of 2 branches missed.">            if (LOG.isDebugEnabled()) {</span>
<span class="nc" id="L276">                LOG.debug(&quot;Created wrapper parent array node '&quot; + segment + &quot;': &quot; + arrayChild);</span>
            }
<span class="fc" id="L278">            childNode = (ObjectNode) arrayChild.get(index);</span>
<span class="fc" id="L279">        } else {</span>
<span class="pc bpc" id="L280" title="1 of 2 branches missed.">            if (parentNode instanceof ObjectNode) {</span>
<span class="fc bfc" id="L281" title="All 2 branches covered.">                if (targetField.getStatus() != FieldStatus.NOT_FOUND) {</span>
<span class="fc" id="L282">                    childNode = ((ObjectNode) parentNode).putObject(cleanedSegment);</span>
                }
<span class="nc bnc" id="L284" title="All 2 branches missed.">            } else if (parentNode instanceof ArrayNode) {</span>
<span class="nc" id="L285">                childNode = ((ArrayNode) parentNode).addObject();</span>
            } else {
<span class="nc" id="L287">                throw new AtlasException(String.format(&quot;Unknown JsonNode type '%s' for segment '%s'&quot;,</span>
<span class="nc" id="L288">                        parentNode.getClass(), segment));</span>
            }
        }
<span class="pc bpc" id="L291" title="1 of 2 branches missed.">        if (LOG.isDebugEnabled()) {</span>
<span class="nc" id="L292">            LOG.debug(&quot;Parent Node '&quot; + parentSegment + &quot;' after adding child parent node '&quot; + segment + &quot;':&quot;</span>
                    + parentNode);
        }
<span class="fc" id="L295">        return childNode;</span>
    }

    private JsonNode createValueNode(Field jsonField) {
<span class="fc" id="L299">        FieldType type = jsonField.getFieldType();</span>
<span class="fc" id="L300">        Object value = jsonField.getValue();</span>
<span class="fc" id="L301">        JsonNode valueNode = null;</span>
<span class="fc bfc" id="L302" title="All 2 branches covered.">        if (value == null) {</span>
<span class="fc" id="L303">            valueNode = rootNode.nullNode();</span>
<span class="fc bfc" id="L304" title="All 2 branches covered.">        } else if (FieldType.STRING.equals(type)) {</span>
<span class="fc" id="L305">            valueNode = rootNode.textNode(String.valueOf(value));</span>
<span class="fc bfc" id="L306" title="All 2 branches covered.">        } else if (FieldType.CHAR.equals(type)) {</span>
<span class="fc" id="L307">            valueNode = rootNode.textNode(Character.toString((char) value));</span>
<span class="fc bfc" id="L308" title="All 2 branches covered.">        } else if (FieldType.BOOLEAN.equals(type)) {</span>
<span class="fc" id="L309">            valueNode = rootNode.booleanNode((Boolean) value);</span>
<span class="fc bfc" id="L310" title="All 2 branches covered.">        } else if (FieldType.INTEGER.equals(type)) {</span>
<span class="fc" id="L311">            valueNode = rootNode.numberNode((Integer) value);</span>
<span class="fc bfc" id="L312" title="All 6 branches covered.">        } else if (FieldType.DOUBLE.equals(type) || FieldType.FLOAT.equals(type) || FieldType.NUMBER.equals(type)) {</span>
<span class="fc" id="L313">            valueNode = rootNode.numberNode(new BigDecimal(String.valueOf(value)));</span>
<span class="fc bfc" id="L314" title="All 2 branches covered.">        } else if (FieldType.SHORT.equals(type)) {</span>
<span class="fc" id="L315">            valueNode = rootNode.numberNode(Short.valueOf(String.valueOf(value)));</span>
<span class="fc bfc" id="L316" title="All 2 branches covered.">        } else if (FieldType.LONG.equals(type)) {</span>
<span class="fc" id="L317">            valueNode = rootNode.numberNode(Long.valueOf(String.valueOf(value)));</span>
<span class="fc bfc" id="L318" title="All 2 branches covered.">        } else if (FieldType.BYTE.equals(type)) {</span>
<span class="fc" id="L319">            valueNode = rootNode.numberNode(Byte.valueOf(String.valueOf(value)));</span>
<span class="pc bpc" id="L320" title="1 of 2 branches missed.">        } else if (FieldType.BIG_INTEGER.equals(type)) {</span>
<span class="fc" id="L321">            valueNode = rootNode.numberNode(new BigInteger(String.valueOf(value)));</span>
        } else {
<span class="nc" id="L323">            valueNode = rootNode.textNode(String.valueOf(value));</span>
        }
<span class="pc bpc" id="L325" title="1 of 2 branches missed.">        if (LOG.isDebugEnabled()) {</span>
<span class="nc bnc" id="L326" title="All 2 branches missed.">            String valueClass = value == null ? &quot;null&quot; : value.getClass().getName();</span>
<span class="nc" id="L327">            LOG.debug(&quot;Converted JsonField value to ValueNode. Type: &quot; + type + &quot;, value: &quot; + value + &quot;(&quot; + valueClass</span>
<span class="nc" id="L328">                    + &quot;), node class: &quot; + valueNode.getClass().getName() + &quot;, node: &quot; + valueNode);</span>
        }
<span class="fc" id="L330">        return valueNode;</span>
    }

    private JsonNode getChildNode(ContainerNode&lt;?&gt; parentNode, SegmentContext parentSegment, SegmentContext segment) {
<span class="pc bpc" id="L334" title="1 of 2 branches missed.">        if (LOG.isDebugEnabled()) {</span>
<span class="nc" id="L335">            LOG.debug(&quot;Looking for child node '&quot; + segment + &quot;' in parent '&quot; + parentSegment + &quot;': &quot; + parentNode);</span>
        }
<span class="fc" id="L337">        String cleanedSegment = segment.getName();</span>
<span class="fc" id="L338">        JsonNode childNode = parentNode.path(cleanedSegment);</span>
<span class="fc bfc" id="L339" title="All 2 branches covered.">        if (JsonNodeType.MISSING.equals(childNode.getNodeType())) {</span>
<span class="fc" id="L340">            childNode = null;</span>
        }
<span class="pc bpc" id="L342" title="1 of 2 branches missed.">        if (LOG.isDebugEnabled()) {</span>
<span class="nc bnc" id="L343" title="All 2 branches missed.">            if (childNode == null) {</span>
<span class="nc" id="L344">                LOG.debug(&quot;Could not find child node '&quot; + segment + &quot;' in parent '&quot; + parentSegment + &quot;'.&quot;);</span>
            } else {
<span class="nc" id="L346">                LOG.debug(&quot;Found child node '&quot; + segment + &quot;' in parent '&quot; + parentSegment + &quot;', class: &quot;</span>
<span class="nc" id="L347">                        + childNode.getClass().getName() + &quot;, node: &quot; + childNode);</span>
            }
        }
<span class="fc" id="L350">        return childNode;</span>
    }

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.8.202204050719</span></div></body></html>